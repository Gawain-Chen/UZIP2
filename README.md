# UZIP2
解压缩小工具，支持自动尝试指定密码。
# 项目由来
最近下载资料多些，解压逐个输入密码过于麻烦，想找个右键菜单一键解压的软件，在网上发现了UZIP2项目，作者是farkaway，应该是放弃维护了，两年没更新了。farkaway在[网站](https://www.yuque.com/farkaway/uzip/gggnsn#l3PpV)上提供了2.22版本和项目源码。我在2.22版本上，根据自己需求做了进一步定制。因该项目在网上无代码托管，并且联系不到作者farkaway，所以修改后的代码无法回流到作者farkaway，故此，我开了本仓库。

# 我的修改

1. 对剪切板导入的密码去重。
2. 程序支持命令行和右键菜单调用，并支持多个文件解压。
3. 优化代码格式，如制表符改成空格，删除多余引用，格式化代码等。
4. 优化临时缓存文件夹相关代码，每个压缩包有单独的缓存文件夹，并且该文件夹是隐藏的。
5. 支持多级解压，压缩包内第一层压缩包再次解压，持续符合条件时会循环解压。


# [UZIP简介](https://www.yuque.com/farkaway/uzip/gggnsn)
UZIP是一个主要用于解压各种压缩档案的小工具，希望它可以为您提供更便利的解压功能。

![功能演示](https://attach.52pojie.cn/forum/202103/15/183448gwdx9o0ao5bno91p.gif)

有别于市面上其他压缩工具，其有以下主要功能特点：
1. 拖拽压缩/拖拽解压。所有的操作通过更直观的拖拽操作完成。

2. 密码管理功能。提供两种密码管理方式：密码本和密码纸，分别对应永久密码和一次性密码。您可以方便的贴入密码，以便在您需要的时候进行解压。

3. 批量测试解压密码。程序在您的密码本和密码纸中查找密码，并自动执行解压。

4. 解压文件过滤。过滤文件中的某些广告推广文件，避免手动删除的困扰。

5. 压缩日志。记录您压缩过的文件位置和解压密码，方便您随时找回。

6. 随机压缩密码生成。确保您每一个压缩文件都有不一样的密码。

7. 任意格式解压。即使文件后缀不是压缩格式，只需要勾选尝试解压位置格式（仅解压模式），就可以直接解压。

8. 从文件名中提取密码。只需要设定分隔标识符，程序就可以从文件名中自动提取解压密码。

9. 将解压密码写到文件名。您压缩的文件的文件名会包含密码信息，即防止在线解压，又避免遗忘密码。


### 运行环境


10. 程序基于 Microsoft .NET Framework 4.5，界面基于WPF 。 

11. WinXP系统应该无法使用，Win10 亲测可用，Win7，Win8未测试（理论可行）。

12. 程序基于cmd.exe命令行调用7z.exe实现解压/压缩功能。部分限制cmd命令行使用的设备无法使用。

### 使用场景

1. 只在固定的网站活动，只使用几个固定的解压密码。
在密码管理器 - 密码本中，填入这些密码，实现永久免密解压。
2. 出没于各个资源论坛，需要和各种各样的密码打交道。
    ○ 复制密码到剪切板，点击密码纸按钮，一键贴入剪切板内的密码到程序。
    ○ 选中密码，使用热键快速贴入程序。
3. 手机或其他设备无法使用程序。
尝试使用，从文件名提取密码。
4. 常常需要压缩文件，但经常忘记压缩密码。
在设置面板中，点击查看压缩日志按钮。输出位置、解压密码都可以找到。
5. 发布资源需要不同的密码。
在设置面板 - 压缩中，选择随机密码。
6. 下载资源里有很多奇奇怪怪的推广文件，找到需要的东西很费劲。
在设置面板 - 解压中，配置文件过滤选项。

### 使用说明

1. 程序基于7Zip 命令行方式进行解压/压缩。您可以通过设置，使用您自己安装的7zip.exe让程序工作。为了方便压缩包内置了32位的7Zip程序文件，可以自行替换为64位版本。
2. 程序做的事仅仅是替你输入命令行让7z工作，然后做一些7z没有做得事情。综合效率没有直接使用7z快，但使用上更方便了，省去了很多记录、查找解压密码的时间。
3. 理论来讲，7z.exe支持的所有格式都可以解压。但由于命令行限制，某些功能可能无法实现。
4. 解压\压缩时没有进度条，文件较大需要耐心等待。但，如果拖入多个文件可以看到文件进度。
5. 要注意，为了实现某些功能，程序会将压缩档案内的文件先解压到输出目录的UZipTempFolder文件夹内，再进行重命名，因此不要误删。
6. 作者是C#萌新，程序难免出现不可预料状况，如给您带来损失请见谅。
